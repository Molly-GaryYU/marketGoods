<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Title</title>

</head>

<style>
    .allGoodsOfStore{

    }
    .allGoodsOfStore span{
        height:  30px;
        line-height: 30px;
        width:150px;
         display: block;
        font-size: 18px;
        color: white;
        font-weight: 700;
        text-align: center;
         }
    .upAndDown{
        height:  30px;
        line-height: 30px;
       margin-left:50px ;
       text-align: right;
    }
    .upAndDown i{
        width: 30%;
    }
    .priceInfo{
        width: 60%;
        margin-left:30px;

    }
    .priceInfoBackGroup{
        margin-top:20px ;
        width: 100%;
      /*  https://img2.baidu.com/it/u=3559135495,311467801&fm=253&fmt=auto&app=138&f=JPEG?w=740&h=433*/
        background-image:url('https://img0.baidu.com/it/u=1419269089,281748380&fm=253&fmt=auto&app=138&f=JPEG?w=668&h=376');
        background-repeat: no-repeat;
        height: 150px;
        background-size: 100% 100%;
    }
</style>
<body>
<!--topInfo-->

<div style="display: flex;align-items: center;height: 20px ;background: floralwhite">
    <div style="float: left;width: 20%;display: flex;color: lightgray;margin-left:10% ">
        <div >
            <a style=";color: lightgray" href="/"><i class="layui-icon layui-icon-home"></i>三小只首页</a>
        </div>
        <div >
            <a style=";color: lightgray" href="#"><i class="layui-icon layui-icon-location place"></i> 广东 </a>
        </div>
    </div>

    <div style="float: right;width: 50%;display: flex;margin-left: 20%" ;>
        <ul style="list-style: none;display: flex;color: lightgray" >
            <li style="display: none" id="userId"  th:value="${userId}"></li>
            <li><a style="font-weight: bold" href="/pages/front/loginPage">尊贵的上帝:
                <span th:text="${nikeName}"></span></a>
                <a href="#" style="color: darkorange;margin-left: 5px">免费注册</a>|</li>
            <li><a href="#" style="margin-left: 5px;color: lightgray"> 我的订单</a>|</li>
            <li><a href="#" style="margin-left: 5px;color: lightgray">我的三小只 </a>|</li>
            <li><a href="#" style="margin-left: 5px;color: lightgray">三小只会员 </a>|</li>
            <li><a href="#" style="margin-left: 5px;color: lightgray">客户服务 </a>|</li>
            <li><a href="#" style="margin-left: 5px;color: lightgray">网站导航 </a>
                <a href="#" style="margin-left: 2px;color: lightgray">  网站无障碍 </a>|</li>

        </ul>

    </div>

</div>
<!--top-->
<div style="width: 80%; margin: 0 auto; display: flex;align-items: center"w>
    <div style="width: 30%">
        <img style="width:272px ;height: 100px;" src="http://localhost:8080\img\index\DogLogo.png"/>
    </div>
    <!-- 搜索框-->
    <div style="width: 50% ;display: flex;border: solid #CC3333 2px">
        <div style="width: 80% ">
            <input type="text" style="width: 100% ;height: 28px ;border:none">
        </div>
        <div   style=" font-weight: 700; color: white;width: 21% ;background: #CC3333;padding: 2px 20px ;text-align: center">
            搜索
        </div>
    </div>

    <div  id=" myShopCar" style="margin-left:5%;  align-items: center; display: flex ; cursor: pointer;width: 20%;background: floralwhite ;color: red;padding: 6px;text-align: center ;">
        <a  style="display: flex; width: 60%; margin: 0 auto; font-weight: 700" href="/pages/front/Customers/ShopCar" >
            我的购物车<i style="margin-left:15%;  width: 20%; display: flex; font-weight: 700" class="layui-icon layui-icon-cart">
            <span th:text="${goodsCount}" style=" display: block; height:20px; width:20px; background:lightsalmon;  border-radius: 4em"></span></i>
        </a>
    </div>

    <!--    登录按钮-->
    <!-- <div  id="loginbtn" style="cursor: pointer;width: 50px; border:2px ;background: rgb(245,245,245) ;padding: 6px;text-align: center ;margin-left: 20px;">
      <a href="/pages/front/loginPage" style="block-size: 2px">
          <i class="layui-icon layui-icon-user">登录</i>
      </a>
     </div>-->
</div>
<div style="margin-top: 30px"></div>
<div style=" border-top:solid palevioletred 1px;width: 100% ">
    <div style="width: 70%;display: flex;margin: 0 auto; "  >

        <div style="background:#CC3333 ;width: 20%;display: flex">
            <div class="allGoodsOfStore">
                <span >本店所有商品</span>
            </div>
            <div class="upAndDown">
                <i style="text-align: right;color: white;" class="layui-icon layui-icon-down"></i>
            </div>
        </div>
        <div style=" width: 80%;background:	#CC0000">
            <span style="color: white;padding-left:30px;font-weight: 700;font-size: 18px ">首页</span>
        </div>
    </div>

</div>
<!--商品展示-->
<div th:each="t:${goods}" style="padding-top: 50px; margin: 0 auto; width: 70%;display: flex;">
    <div style="width:40% ">
       <img style="width: 100%;height: 450px" th:src="${t.img}">
    </div>
    <div class="priceInfo" >
        <!--商品标题-->
        <div style="width: 100%;display: flex" >
            <span style=" font-weight: 700 ;font-size: 18px" th:text="${t.title}"></span>
        </div>
        <div class="priceInfoBackGroup" >
        <!--    价格-->
            <div style="width: 100% ;height: 20px;padding-top: 15px">
                <span style="margin-left:10px;color:grey">价格</span>
                <span style="font-size:20px;  margin-left: 68px;font-weight: bold ">￥</span>
                <span style="font-size:20px; font-weight: bold ;text-decoration: line-through " th:text= "${t.oldPrice}">价格</span>
            </div>
            <div style="width: 100% ;height: 20px;padding-top: 15px;">
                <span style="margin-left:10px;color:grey">促销价</span>
                <span style="color: red; font-size:25px;  margin-left: 50px;">￥</span>
                <span style="color: red;font-size:30px; font-weight: 700 ;" th:text= "${t.oldPrice}">价格</span>
                <span style="margin-top:17px;  margin-right: 55%; float: right;display: block; width:70px;text-align: center; background-color: lightcoral;color: white;">品牌钜惠 </span>
            </div>
            <div style="width: 100% ;height: 20px;padding-top: 15px;margin-top:20px ">
                <span style="margin-left:10px;color:grey">价格</span>
                <span style="color:snow;margin-left: 68px;font-size: 15px ">满148元 减20元</span>
            </div> </div>
            <!--运费-->
            <div style="margin-top:20px ; display: flex; height: 50px; width: 100% ;">
                <span style="margin-left:10px;color:grey">运费</span>
                <span style="  margin-left: 68px;">我三小只商城承诺运费均为公益免费！听懂掌声！</span>
            </div>

            <!--月售-->
            <div style="; display: flex; height: 50px; width: 100% ;border-top : lightpink dashed 1px;border-bottom : lightpink dashed 1px">
               <div style="width: 49% ;text-align: center;line-height: 50px">
                   <span style="color: lightgray">月销量</span>
                  <span style="color: red" th:text="${t.evaluationCount}">+</span>
               </div>
                <div style="width: 2%;line-height: 50px">
                    <span>|</span>
                </div>
                <div style="width: 49%;text-align: center;line-height: 50px">
                    <span style="color: lightgray;font-weight: bold">送三小只积分</span>
                    <span style="color: green;font-weight: bold" >45</span>
                </div>
            </div>
            <!--数量-->
        <div style="width: 100% ;height: 30px;padding-top: 15px;display: flex">
            <span style="margin-left:10px;color:grey;line-height: 30px">数量</span>
           <div class="addOrDel" style="display: flex;width: 50%;margin-left:68px ">
               <a  id="add"  style="cursor: pointer; line-height: 30px; text-align: center; display: block; height: 31px; width:15px;margin-right: 0px; border: lightgray 1px solid; background: white">+</a>
               <!--   class="count" -->
               <input id="num" type="text" style="text-align: center; width: 30px; height: 30px; margin-left:0px ; border:1px solid lightgray; " value="1" >
               <!--  class="delCount"  -->
               <a id="del" style="cursor: pointer;line-height: 30px;text-align: center; display: block; height: 31px;width:15px;margin-left: 0px; border: lightgray 1px solid; background: white">-</a>
           </div>
        </div>
      <!--  两个按钮-->
        <div style="display: flex;width: 80%;margin-top: 20px;margin-left:17.5%">
            <div style="width: 80%;text-align: center">
              <button href="" id="buy" style="height: 45px; color: red;width: 180px; cursor: pointer; text-align: center; font-size: 15px;background-color: #FFF0F5 ;border:red solid 1px">立即购买</button>
                <!--    th:value="${t.goodsId}"-->
             <!--   th:href="@{/pages/front/Customers/addGoodsToCar/{goodsId}/{userId}/(goodsId=${t.goodsId},userId=${userId}) }"-->
                <a href=""> <button id="addToCar" style="margin-left: 25px; height: 45px;width: 180px; cursor: pointer; text-align: center;font-size: 15px; color: white; background-color: red ;border:red solid ">加入购物车</button></a>
           </div>
        </div>
    </div>
   <!-- <div style="width: 100% ;display: flex" th:text="${t.detail}"></div>
-->
</div>

</body>

<script src="https://s3.pstatp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js" crossorigin="anonymous"></script>
<!--计时器-->
<script type="text/javascript" >
    $('#del').click(function () {
        var num=document.getElementById('num')
        var numdel= parseInt(num.value) ;
        if (numdel==0){
            numdel=0;
        }else {
            numdel--;
        }
        num.value=numdel;
     /*   $('#num').empty();*/
    })
    $('#add').click(function () {
        var num=document.getElementById('num')
        var numdel= parseInt(num.value) ;
        numdel++;
        num.value=numdel;
    });
</script>

<script type="text/javascript" th:inline="javascript">
    $('#addToCar').click(function () {
    var userId=parseInt($('#userId').val()) ;
    var goods=[[${goods}]] ;

    var goodsId=parseInt(goods.goodsId) ;
    var count=parseInt($('#num').val());
    var shopCar={
        userId,
        goodsId,
        count
    }
    $.post("/pages/front/Customers/addGoodsToCar",shopCar,function(data) {
      alert(data);
      console.log(data);
         //
         /* 解决方法在js中实现页面跳转需要加入本地路径http://localhost:8080/否者会出现方法错误
         *    encodeURIComponent() 函数可把字符串作为 URI 组件进行编码。
         *    还需要将data发挥的shopCar对象转换为json字符串才能成功带参数跳转
         * */
      /*    var shopCar=data.shopCar
          $.ajax({
              type: "POST",
                url:"/pages/front/Customers/addGoodsToCar", //请求页面
         /!*     url:"/pages/front/UserAddGoodsLogin",//请求后端*!/
              data: {data:shopCar},
              dataType: "json",
              complete:function(){
                  location.href ="http://localhost:8080/pages/front/loginPage"
              }//跳转页面
          });*/




        /*  $.post("/pages/front/Customers/addGoodsToCar")*/
      /*   window.location.href="http://localhost:8080/pages/front/loginPage?shopcar="+ encodeURIComponent(shopcar) ;*/
       /*   window.location.href="http://localhost:8080/pages/front/loginPage";*/
    });

    });
</script>
<script type="text/javascript" th:inline="javascript">
 $('#buy').click(function () {
     var goods=[[${goods}]] ;
     var userId=parseInt($('#userId').val()) ;
     var goodsId=parseInt(goods.goodsId) ;
     var count=parseInt($('#num').val());
     if (userId==0){
         alert('请您先登录哦~')
     }else {
         window.location.href="http://localhost:8080/pages/front/Customers/orderGenerate?userId="+userId+'&goodsId='+goodsId+'&count='+count;

     }

 })
</script>
</html>